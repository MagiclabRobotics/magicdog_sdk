---
title: 语音控制服务
createTime: 2025/01/27 15:30:00
permalink: /dog/python_audio_reference/
---

# 语音服务 (Python)

> 提供机器人系统音频控制，包括 TTS 语音合成、音频播放、语音配置。

## 接口定义

<code>AudioController</code> 是机器人音频控制，包括 TTS 语音合成、音频播放、语音配置。

### <code>AudioController</code> — 音频控制器

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>类名</td><td><code>AudioController</code></td></tr>
    <tr><td>功能概述</td><td>机器人音频控制，包括 TTS 语音合成、音频播放、语音配置</td></tr>
    <tr><td>主要功能</td><td>语音播放、音量控制、语音模型切换、原始音频数据订阅</td></tr>
    <tr><td>使用场景</td><td>语音交互、音频播放、语音识别</td></tr>
  </tbody>
</table>

### initialize
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>initialize</code></td></tr>
    <tr><td>方法声明</td><td><code>bool initialize()</code></td></tr>
    <tr><td>功能概述</td><td>初始化音频控制器。</td></tr>
    <tr><td>返回值</td><td><code>true</code> 表示成功，<code>false</code> 表示失败。</td></tr>
    <tr><td>备注</td><td>首次使用前必须调用。</td></tr>
  </tbody>
</table>

### shutdown
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>shutdown</code></td></tr>
    <tr><td>方法声明</td><td><code>void shutdown()</code></td></tr>
    <tr><td>功能概述</td><td>关闭音频控制器。</td></tr>
    <tr><td>备注</td><td>配合 initialize 使用。</td></tr>
  </tbody>
</table>

### play
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>play</code></td></tr>
    <tr><td>方法声明</td><td><code>Status play(TtsCommand command)</code></td></tr>
    <tr><td>功能概述</td><td>播放 TTS（文本转语音）语音命令。</td></tr>
    <tr><td>参数说明</td><td><code>command</code>：TTS 命令，包含文本、语速、语调等。</td></tr>
    <tr><td>返回值</td><td><code>Status::OK</code> 表示成功，其他为失败状态。</td></tr>
    <tr><td>备注</td><td>阻塞接口，调用前需确保已初始化模块。</td></tr>
  </tbody>
</table>

### stop
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>stop</code></td></tr>
    <tr><td>方法声明</td><td><code>Status stop()</code></td></tr>
    <tr><td>功能概述</td><td>停止当前音频播放。</td></tr>
    <tr><td>返回值</td><td><code>Status::OK</code> 表示成功，其他为失败状态。</td></tr>
    <tr><td>备注</td><td>阻塞接口，通常用于中断当前语音。</td></tr>
  </tbody>
</table>

### set_volume
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>set_volume</code></td></tr>
    <tr><td>方法声明</td><td><code>Status set_volume(int volume)</code></td></tr>
    <tr><td>功能概述</td><td>设置音频输出的音量。</td></tr>
    <tr><td>参数说明</td><td><code>volume</code>：音量值，通常范围为 0~100。</td></tr>
    <tr><td>返回值</td><td><code>Status::OK</code> 表示成功，其他为失败状态。</td></tr>
    <tr><td>备注</td><td>阻塞接口，设置后立即生效。</td></tr>
  </tbody>
</table>

### get_volume
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_volume</code></td></tr>
    <tr><td>方法声明</td><td><code>int get_volume()</code></td></tr>
    <tr><td>功能概述</td><td>获取当前音频输出音量。</td></tr>
    <tr><td>返回值</td><td>当前音量值，失败返回 -1。</td></tr>
    <tr><td>备注</td><td>非阻塞接口。</td></tr>
  </tbody>
</table>

### switch_tts_voice_model
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>switch_tts_voice_model</code></td></tr>
    <tr><td>方法声明</td><td><code>Status switch_tts_voice_model(TtsType tts_type, GetSpeechConfig config)</code></td></tr>
    <tr><td>功能概述</td><td>切换语音模型并获取更新后的配置信息。</td></tr>
    <tr><td>参数说明</td><td><code>tts_type</code>：要切换的语音模型类型<br><code>config</code>：语音配置对象</td></tr>
    <tr><td>返回值</td><td><code>Status::OK</code> 表示成功，其他为失败状态。</td></tr>
    <tr><td>备注</td><td>阻塞接口，切换语音模型后会自动更新配置信息。</td></tr>
  </tbody>
</table>

### get_voice_config
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>get_voice_config</code></td></tr>
    <tr><td>方法声明</td><td><code>GetSpeechConfig get_voice_config()</code></td></tr>
    <tr><td>功能概述</td><td>获取语音系统的完整配置信息。</td></tr>
    <tr><td>返回值</td><td>语音系统配置信息，失败返回空配置对象。</td></tr>
    <tr><td>备注</td><td>阻塞接口，获取的配置包含音色、智能体、唤醒、对话等所有子配置。</td></tr>
  </tbody>
</table>

### set_voice_config
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>set_voice_config</code></td></tr>
    <tr><td>方法声明</td><td><code>Status set_voice_config(SetSpeechConfig config)</code></td></tr>
    <tr><td>功能概述</td><td>设置语音系统的完整配置信息。</td></tr>
    <tr><td>参数说明</td><td><code>config</code>：要设置的语音系统配置信息。</td></tr>
    <tr><td>返回值</td><td><code>Status::OK</code> 表示成功，其他为失败状态。</td></tr>
    <tr><td>备注</td><td>阻塞接口，设置的配置将完全覆盖当前所有语音相关配置。</td></tr>
  </tbody>
</table>

### control_voice_stream
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>control_voice_stream</code></td></tr>
    <tr><td>方法声明</td><td><code>Status control_voice_stream(bool raw_data, bool bf_data)</code></td></tr>
    <tr><td>功能概述</td><td>控制语音数据流。</td></tr>
    <tr><td>参数说明</td><td><code>raw_data</code>：是否发送原始数据<br><code>bf_data</code>：是否发送 bf 数据</td></tr>
    <tr><td>返回值</td><td><code>Status::OK</code> 表示成功，其他为失败。</td></tr>
    <tr><td>备注</td><td>阻塞接口，用于控制语音数据流的开启和关闭。</td></tr>
  </tbody>
</table>

### subscribe_origin_voice_data
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>subscribe_origin_voice_data</code></td></tr>
    <tr><td>方法声明</td><td><code>void subscribe_origin_voice_data(Callable callback)</code></td></tr>
    <tr><td>功能概述</td><td>订阅原始语音数据。</td></tr>
    <tr><td>参数说明</td><td><code>callback</code>：接收到原始语音数据后的处理回调</td></tr>
    <tr><td>备注</td><td>非阻塞接口，回调函数会在数据更新时被调用。</td></tr>
  </tbody>
</table>

### subscribe_bf_voice_data
<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>项目</strong></th>
      <th style="width: 60%; text-align: center;"><strong>内容</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td>方法名</td><td><code>subscribe_bf_voice_data</code></td></tr>
    <tr><td>方法声明</td><td><code>void subscribe_bf_voice_data(Callable callback)</code></td></tr>
    <tr><td>功能概述</td><td>订阅 BF 语音数据。</td></tr>
    <tr><td>参数说明</td><td><code>callback</code>：接收到 BF 语音数据后的处理回调</td></tr>
    <tr><td>备注</td><td>非阻塞接口，回调函数会在数据更新时被调用。</td></tr>
  </tbody>
</table>


## 枚举类型定义

### <code>TtsPriority</code> — TTS 优先级枚举

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>枚举值</strong></th>
      <th style="width: 20%; text-align: center;"><strong>数值</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>HIGH</code></td><td>0</td><td>高优先级</td></tr>
    <tr><td><code>MIDDLE</code></td><td>1</td><td>中优先级</td></tr>
    <tr><td><code>LOW</code></td><td>2</td><td>低优先级</td></tr>
  </tbody>
</table>

### <code>TtsMode</code> — TTS 模式枚举

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>枚举值</strong></th>
      <th style="width: 20%; text-align: center;"><strong>数值</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>CLEARTOP</code></td><td>0</td><td>清除顶部</td></tr>
    <tr><td><code>ADD</code></td><td>1</td><td>添加</td></tr>
    <tr><td><code>CLEARBUFFER</code></td><td>2</td><td>清除缓冲区</td></tr>
  </tbody>
</table>

### <code>TtsType</code> — TTS 类型枚举

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>枚举值</strong></th>
      <th style="width: 20%; text-align: center;"><strong>数值</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>NONE</code></td><td>0</td><td>无</td></tr>
    <tr><td><code>DOUBAO</code></td><td>1</td><td>豆包</td></tr>
    <tr><td><code>GOOGLE</code></td><td>2</td><td>谷歌</td></tr>
  </tbody>
</table>

## 数据结构定义

### <code>TtsCommand</code> — TTS 命令结构体

<table style="width: 100%; table-layout: fixed; border-collapse: collapse; text-align: left;">
  <thead>
    <tr>
      <th style="width: 40%; text-align: center;"><strong>字段名</strong></th>
      <th style="width: 20%; text-align: center;"><strong>类型</strong></th>
      <th style="width: 40%; text-align: center;"><strong>描述</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr><td><code>id</code></td><td><code>int</code></td><td>命令 ID</td></tr>
    <tr><td><code>content</code></td><td><code>str</code></td><td>内容</td></tr>
    <tr><td><code>priority</code></td><td><code>TtsPriority</code></td><td>优先级</td></tr>
    <tr><td><code>mode</code></td><td><code>TtsMode</code></td><td>模式</td></tr>
  </tbody>
</table>